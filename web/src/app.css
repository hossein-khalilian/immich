@import 'tailwindcss';
@import '@immich/ui/theme/default.css';
@source "../node_modules/@immich/ui";
/* @import '/usr/ui/dist/theme/default.css'; */

/* RTL Support */
[dir='rtl'] {
  direction: rtl;
}

[dir='ltr'] {
  direction: ltr;
}

@utility immich-form-input {
  @apply rounded-xl bg-slate-200 px-3 py-3 text-sm focus:border-immich-primary disabled:cursor-not-allowed disabled:bg-gray-400 disabled:text-gray-100 dark:bg-gray-600 dark:text-immich-dark-fg dark:disabled:bg-gray-800 dark:disabled:text-gray-200;
}

@utility immich-form-label {
  @apply font-medium text-gray-500 dark:text-gray-300;
}

@utility immich-scrollbar {
  /* width */
  scrollbar-width: thin;
}

@utility scrollbar-hidden {
  /* Hidden scrollbar */
  /* width */
  scrollbar-width: none;
}

@utility scrollbar-stable {
  scrollbar-gutter: stable both-edges;
}

@utility grid-auto-fit-* {
  grid-template-columns: repeat(auto-fit, minmax(min(calc(var(--spacing) * --value(number)), 100%), 1fr));
}

@utility grid-auto-fill-* {
  grid-template-columns: repeat(auto-fill, minmax(min(calc(var(--spacing) * --value(number)), 100%), 1fr));
}

@custom-variant dark (&:where(.dark, .dark *):not(.light));

@theme inline {
  --color-immich-primary: rgb(var(--immich-primary));
  --color-immich-bg: rgb(var(--immich-bg));
  --color-immich-fg: rgb(var(--immich-fg));
  --color-immich-gray: rgb(var(--immich-gray));

  --color-immich-dark-primary: rgb(var(--immich-dark-primary));
  --color-immich-dark-bg: rgb(var(--immich-dark-bg));
  --color-immich-dark-fg: rgb(var(--immich-dark-fg));
  --color-immich-dark-gray: rgb(var(--immich-dark-gray));
}

@theme {
  --font-immich-mono: Overpass Mono, monospace;

  --spacing-18: 4.5rem;

  --breakpoint-tall: 800px;
  --breakpoint-2xl: 1535px;
  --breakpoint-xl: 1279px;
  --breakpoint-lg: 1023px;
  --breakpoint-md: 767px;
  --breakpoint-sm: 639px;
  --breakpoint-sidebar: 850px;
}

@layer base {
  :root {
    /* light */
    --immich-primary: 66 80 175;
    --immich-bg: 255 255 255;
    --immich-fg: 0 0 0;

    /* dark */
    --immich-dark-primary: 172 203 250;
    --immich-dark-bg: 10 10 10;
    --immich-dark-fg: 229 231 235;
    --immich-dark-gray: 33 33 33;
  }

  button:not(:disabled),
  [role='button']:not(:disabled) {
    cursor: pointer;
  }
}

@layer utilities {
  @font-face {
    font-family: 'Overpass';
    src: url('$lib/assets/fonts/overpass/Overpass.ttf') format('truetype-variations');
    font-weight: 1 999;
    font-style: normal;
    ascent-override: 106.25%;
    size-adjust: 106.25%;
  }

  @font-face {
    font-family: 'Overpass Mono';
    src: url('$lib/assets/fonts/overpass/OverpassMono.ttf') format('truetype-variations');
    font-weight: 1 999;
    font-style: monospace;
    ascent-override: 106.25%;
    size-adjust: 106.25%;
  }

  /* Yekan font for Persian - using local files */
  @font-face {
    font-family: 'Yekan';
    src: url('$lib/assets/fonts/yekan/Yekan.woff2') format('woff2'),
         url('$lib/assets/fonts/yekan/Yekan.woff') format('woff'),
         url('$lib/assets/fonts/yekan/Yekan.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
    font-display: swap;
  }

  @font-face {
    font-family: 'Yekan';
    src: url('$lib/assets/fonts/yekan/YekanBold.woff2') format('woff2'),
         url('$lib/assets/fonts/yekan/YekanBold.woff') format('woff'),
         url('$lib/assets/fonts/yekan/YekanBold.ttf') format('truetype');
    font-weight: bold;
    font-style: normal;
    font-display: swap;
  }

  :root {
    font-family: 'Overpass', sans-serif;
    /* Used by layouts to ensure proper spacing between navbar and content */
    --navbar-height: calc(4.5rem + 4px);
    --navbar-height-md: calc(4.5rem + 4px - 14px);
  }

  /* Use Yekan font for RTL languages */
  html[dir='rtl'],
  body[dir='rtl'],
  [dir='rtl'] {
    font-family: 'Yekan', 'Vazir', 'Tahoma', 'Arial', sans-serif;
  }
  
  /* Apply Yekan to all elements in RTL context */
  [dir='rtl'] * {
    font-family: inherit;
  }

  /* Remove text-transform capitalize for RTL languages (Persian, Arabic, etc.) */
  [dir='rtl'] .capitalize,
  [dir='rtl'] [class*='capitalize'] {
    text-transform: none !important;
  }
  
  /* Disable first-letter capitalization in RTL */
  [dir='rtl'] .first-letter\:capitalize::first-letter,
  [dir='rtl'] [class*='first-letter:capitalize']::first-letter {
    text-transform: none !important;
  }

  /* Flip chevron navigation icons in RTL (previous/next arrows should be reversed) */
  /* Flip icons in navigation area buttons */
  [dir='rtl'] .navigation-area-button svg {
    transform: scaleX(-1);
  }
  
  /* Flip chevron icons in IconButtons with previous/next aria-labels */
  [dir='rtl'] button[aria-label*='previous'] svg,
  [dir='rtl'] button[aria-label*='Previous'] svg,
  [dir='rtl'] button[aria-label*='قبلی'] svg,
  [dir='rtl'] button[aria-label*='next'] svg,
  [dir='rtl'] button[aria-label*='Next'] svg,
  [dir='rtl'] button[aria-label*='بعدی'] svg {
    transform: scaleX(-1);
  }

  /* Flip back/return arrow icons in RTL */
  /* Target IconButtons with back arrow icons - using aria-label matching */
  [dir='rtl'] button[aria-label*='back'] svg,
  [dir='rtl'] button[aria-label*='Back'] svg,
  [dir='rtl'] button[aria-label*='بازگشت'] svg,
  [dir='rtl'] button[aria-label*='go_back'] svg,
  [dir='rtl'] [aria-label*='back'] svg,
  [dir='rtl'] [aria-label*='Back'] svg,
  [dir='rtl'] [aria-label*='بازگشت'] svg,
  [dir='rtl'] [aria-label*='go_back'] svg {
    transform: scaleX(-1);
  }
  
  /* Flip close action buttons that use arrow left icon */
  [dir='rtl'] button[aria-label*='close'] svg,
  [dir='rtl'] button[aria-label*='Close'] svg,
  [dir='rtl'] button[aria-label*='بستن'] svg {
    transform: scaleX(-1);
  }
  
/* Flip arrow left icons in control app bar and other back buttons */
/* This targets buttons that use mdiArrowLeft icon */
[dir='rtl'] #asset-selection-app-bar button svg,
[dir='rtl'] button[data-back-button] svg {
  transform: scaleX(-1);
}

/* Fix JalaliDatePicker z-index and pointer events - minimal CSS to avoid breaking styles */
/* Only fix z-index and pointer-events, don't override other styles */
body > div[class*="jdp"]:not([class*="jdp-hidden"]),
body > div[class*="jalali"]:not([class*="jdp-hidden"]) {
  z-index: 999999 !important;
  pointer-events: auto !important;
}

body > div[class*="jdp"]:not([class*="jdp-hidden"]) *,
body > div[class*="jalali"]:not([class*="jdp-hidden"]) * {
  pointer-events: auto !important;
}

  :root.dark {
    color-scheme: dark;
  }

  :root:not(.dark) {
    color-scheme: light;
  }

  html {
    height: 100%;
    width: 100%;
  }

  html::-webkit-scrollbar {
    width: 8px;
  }

  /* Track */
  html::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 16px;
  }

  /* Handle */
  html::-webkit-scrollbar-thumb {
    background: rgba(85, 86, 87, 0.408);
    border-radius: 16px;
  }

  /* Handle on hover */
  html::-webkit-scrollbar-thumb:hover {
    background: #4250afad;
    border-radius: 16px;
  }

  body {
    margin: 0;
    color: #3a3a3a;
  }

  input:focus-visible {
    outline-offset: 0px !important;
    outline: none !important;
  }

  .text-white-shadow {
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
  }

  .icon-white-drop-shadow {
    filter: drop-shadow(0 0 1px rgba(0, 0, 0, 0.8));
  }
}

.maplibregl-popup {
  .maplibregl-popup-tip {
    @apply border-t-subtle! translate-y-[-1px];
  }

  .maplibregl-popup-content {
    @apply bg-subtle rounded-lg;
  }
}

/* Fix JalaliDatePicker z-index and pointer events - minimal CSS to avoid breaking styles */
/* Only fix z-index and pointer-events, don't override other styles */
jdp-container {
  pointer-events: auto !important;
}

body > div[class*="jdp"]:not([class*="jdp-hidden"]),
body > div[class*="jalali"]:not([class*="jdp-hidden"]) {
  z-index: 999999 !important;
  pointer-events: auto !important;
}

body > div[class*="jdp"]:not([class*="jdp-hidden"]) *,
body > div[class*="jalali"]:not([class*="jdp-hidden"]) * {
  pointer-events: auto !important;
}
